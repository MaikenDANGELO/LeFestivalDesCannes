{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapActions, mapState } from 'vuex';\nimport moneyService from '@/services/money.service';\nexport default {\n  name: \"PageDon\",\n  data() {\n    return {\n      prestataire: null,\n      premadeAmount: [\"5\", \"10\", \"20\"],\n      userInput: \"0\",\n      montantDon: \"5\",\n      isDonValide: true,\n      message: \"\",\n      payment: {\n        cardNumber: \"\",\n        expirationDate: \"\",\n        cvv: \"\"\n      }\n    };\n  },\n  methods: {\n    ...mapActions('prestataire', ['getAllPrestataires']),\n    ...mapActions('utilisateurs', ['getAllUsers']),\n    getUtilisateur(id) {\n      return this.utilisateurs.find(u => u['id_utilisateur'] === id);\n    },\n    checkIsMontantValide() {\n      if (this.montantDon > 0) this.isDonValide = true;else this.isDonValide = false;\n    },\n    updateMontantDon() {\n      if (parseInt(this.userInput) && this.userInput > 0) {\n        this.montantDon = this.userInput;\n        this.isDonValide = true;\n      } else {\n        this.isDonValide = false;\n      }\n    },\n    async makeDonation() {\n      let response;\n      console.log(\"Réalisation d'un don..\");\n      try {\n        console.log(this.utilisateur.id, this.prestataire.id, parseInt(this.montantDon), this.message);\n        response = await moneyService.makeDonation(parseInt(this.utilisateur.id), this.prestataire.id, parseInt(this.montantDon), this.message);\n        console.log(response);\n      } catch (e) {\n        response = e;\n      }\n      return response;\n    }\n  },\n  computed: {\n    ...mapState('utilisateurs', ['utilisateur', 'utilisateurs']),\n    ...mapState('prestataire', [\"avis_prestataire\", \"prestataires\"])\n  },\n  async created() {\n    if (!this.utilisateur || !this.utilisateur.estConnecte) this.$router.push('/');\n    await this.getAllPrestataires();\n    await this.getAllUsers();\n    const id = this.$route.params.id;\n    this.prestataire = this.prestataires.find(p => p.id === id); // récupère le prestataire d'après l'id renseignée depuis la Page  principale    \n  }\n};","map":{"version":3,"names":["mapActions","mapState","moneyService","name","data","prestataire","premadeAmount","userInput","montantDon","isDonValide","message","payment","cardNumber","expirationDate","cvv","methods","getUtilisateur","id","utilisateurs","find","u","checkIsMontantValide","updateMontantDon","parseInt","makeDonation","response","console","log","utilisateur","e","computed","created","estConnecte","$router","push","getAllPrestataires","getAllUsers","$route","params","prestataires","p"],"sources":["src/views/PageDon.vue"],"sourcesContent":["<template>\n    <div class=\"prestataire-detail\" v-if=\"prestataire\">\n        <h1>Faire un don à {{ prestataire.nom }}</h1>\n        <div>\n            <input @change=\"checkIsMontantValide()\" id=\"montant5\" type=\"radio\" value=\"5\" v-model=\"montantDon\">\n            <label for=\"montant5\">5€ </label>\n            <input @change=\"checkIsMontantValide()\" id=\"montant10\" type=\"radio\" value=\"10\" v-model=\"montantDon\">\n            <label for=\"montant10\">10€ </label>\n            <input @change=\"checkIsMontantValide()\" id=\"montant20\" type=\"radio\" value=\"20\" v-model=\"montantDon\">\n            <label for=\"montant20\">20€ </label>\n            <input @change=\"checkIsMontantValide()\" id=\"montant0\" type=\"radio\" value=\"0\" v-model=\"montantDon\">\n            <label for=\"montant0\">Choisir un montant personnalisé </label><br>\n            <div v-if=\"!premadeAmount.includes(montantDon)\">\n                <label for=\"personnalise\">Entrer un montant personnalisé: </label>\n                <input id=\"personnalise\" type=\"text\" @change=\"updateMontantDon()\" v-model=\"userInput\">\n            </div>\n            <div v-if=\"isDonValide\">\n                <p>Montant choisi: {{ montantDon }} €</p><br>\n                <label for=\"message\">Message personnalisé (optionnel): </label>\n                <input id=\"message\" type=\"text\" style=\"overflow-y: scroll;\" placeholder=\"Message optionnel\"\n                    v-model=\"message\"><br><br>\n                <div>\n                    <form>\n                        <h2>Paiement</h2>\n\n                        <div class=\"form-group\">\n                            <label for=\"cardNumber\">Numéro de carte :</label>\n                            <input v-model=\"payment.cardNumber\" type=\"text\" id=\"cardNumber\" pattern=\"\\d{16,}\"\n                                placeholder=\"Numéro de carte\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"expirationDate\">Date d'expiration :</label>\n                            <input v-model=\"payment.expirationDate\" type=\"text\" id=\"expirationDate\"\n                                pattern=\"^(0[1-9]|1[0-2])\\/\\d{2}$\" placeholder=\"MM/AA\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <label for=\"cvv\">CVV :</label>\n                            <input v-model=\"payment.cvv\" type=\"text\" id=\"cvv\" placeholder=\"CVV\" required>\n                        </div>\n\n                        <div class=\"form-group\">\n                            <p><strong>Total à payer : {{ montantDon }} €</strong></p>\n                        </div>\n                        <input type=\"submit\" @click=\"makeDonation()\">\n                    </form>\n                </div>\n            </div>\n            <div v-else>\n                <p style=\"color: red;\">Veuillez entrer un montant valide</p>\n            </div>\n        </div>\n    </div>\n    <div v-else>\n        <p>Chargement des données...</p>\n    </div>\n</template>\n\n<script>\nimport { mapActions, mapState } from 'vuex';\nimport moneyService from '@/services/money.service';\n\nexport default {\n    name: \"PageDon\",\n    data() {\n        return {\n            prestataire: null,\n            premadeAmount: [\"5\", \"10\", \"20\"],\n            userInput: \"0\",\n            montantDon: \"5\",\n            isDonValide: true,\n            message: \"\",\n            payment: {\n                cardNumber: \"\",\n                expirationDate: \"\",\n                cvv: \"\",\n            },\n        };\n    },\n    methods: {\n        ...mapActions('prestataire', ['getAllPrestataires']),\n        ...mapActions('utilisateurs', ['getAllUsers']),\n        getUtilisateur(id) {\n            return this.utilisateurs.find(u => u['id_utilisateur'] === id);\n        },\n        checkIsMontantValide() {\n            if (this.montantDon > 0) this.isDonValide = true;\n            else this.isDonValide = false;\n        },\n        updateMontantDon() {\n            if (parseInt(this.userInput) && this.userInput > 0) {\n                this.montantDon = this.userInput;\n                this.isDonValide = true;\n            } else {\n                this.isDonValide = false;\n            }\n        },\n        async makeDonation() {\n            let response;\n            console.log(\"Réalisation d'un don..\")\n            try {\n                console.log(this.utilisateur.id, this.prestataire.id, parseInt(this.montantDon), this.message)\n                response = await moneyService.makeDonation(parseInt(this.utilisateur.id), this.prestataire.id, parseInt(this.montantDon), this.message);\n                console.log(response)\n            } catch (e) {\n                response = e;\n            }\n\n            return response;\n        }\n    },\n    computed: {\n        ...mapState('utilisateurs', ['utilisateur', 'utilisateurs']),\n        ...mapState('prestataire', [\"avis_prestataire\", \"prestataires\"])\n    },\n    async created() {\n        if (!this.utilisateur || !this.utilisateur.estConnecte) this.$router.push('/');\n        await this.getAllPrestataires();\n        await this.getAllUsers();\n        const id = this.$route.params.id;\n        this.prestataire = this.prestataires.find(p => p.id === id); // récupère le prestataire d'après l'id renseignée depuis la Page  principale    \n    },\n};\n</script>\n\n<style scoped></style>"],"mappings":";AA4DA,SAAAA,UAAA,EAAAC,QAAA;AACA,OAAAC,YAAA;AAEA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,WAAA;MACAC,aAAA;MACAC,SAAA;MACAC,UAAA;MACAC,WAAA;MACAC,OAAA;MACAC,OAAA;QACAC,UAAA;QACAC,cAAA;QACAC,GAAA;MACA;IACA;EACA;EACAC,OAAA;IACA,GAAAf,UAAA;IACA,GAAAA,UAAA;IACAgB,eAAAC,EAAA;MACA,YAAAC,YAAA,CAAAC,IAAA,CAAAC,CAAA,IAAAA,CAAA,uBAAAH,EAAA;IACA;IACAI,qBAAA;MACA,SAAAb,UAAA,WAAAC,WAAA,aACA,KAAAA,WAAA;IACA;IACAa,iBAAA;MACA,IAAAC,QAAA,MAAAhB,SAAA,UAAAA,SAAA;QACA,KAAAC,UAAA,QAAAD,SAAA;QACA,KAAAE,WAAA;MACA;QACA,KAAAA,WAAA;MACA;IACA;IACA,MAAAe,aAAA;MACA,IAAAC,QAAA;MACAC,OAAA,CAAAC,GAAA;MACA;QACAD,OAAA,CAAAC,GAAA,MAAAC,WAAA,CAAAX,EAAA,OAAAZ,WAAA,CAAAY,EAAA,EAAAM,QAAA,MAAAf,UAAA,QAAAE,OAAA;QACAe,QAAA,SAAAvB,YAAA,CAAAsB,YAAA,CAAAD,QAAA,MAAAK,WAAA,CAAAX,EAAA,QAAAZ,WAAA,CAAAY,EAAA,EAAAM,QAAA,MAAAf,UAAA,QAAAE,OAAA;QACAgB,OAAA,CAAAC,GAAA,CAAAF,QAAA;MACA,SAAAI,CAAA;QACAJ,QAAA,GAAAI,CAAA;MACA;MAEA,OAAAJ,QAAA;IACA;EACA;EACAK,QAAA;IACA,GAAA7B,QAAA;IACA,GAAAA,QAAA;EACA;EACA,MAAA8B,QAAA;IACA,UAAAH,WAAA,UAAAA,WAAA,CAAAI,WAAA,OAAAC,OAAA,CAAAC,IAAA;IACA,WAAAC,kBAAA;IACA,WAAAC,WAAA;IACA,MAAAnB,EAAA,QAAAoB,MAAA,CAAAC,MAAA,CAAArB,EAAA;IACA,KAAAZ,WAAA,QAAAkC,YAAA,CAAApB,IAAA,CAAAqB,CAAA,IAAAA,CAAA,CAAAvB,EAAA,KAAAA,EAAA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}